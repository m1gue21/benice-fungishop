---
import Layout from '../layouts/Layout.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import Cart from '../components/Cart.astro';

const products = [
  {
    id: 1,
    name: "Microdosis Melena de León",
    price: 35000,
    originalPrice: 42000,
    image: "https://images.pexels.com/photos/7195706/pexels-photo-7195706.jpeg?auto=compress&cs=tinysrgb&w=500",
    description: "Mejora tu concentración y memoria con nuestras microdosis de melena de león premium",
    benefits: ["Concentración", "Memoria", "Neuroprotección", "Claridad Mental"],
    category: "microdosis",
    featured: true,
    inStock: true
  },
  {
    id: 2,
    name: "Extracto de Reishi Premium",
    price: 42000,
    image: "https://images.pexels.com/photos/7195692/pexels-photo-7195692.jpeg?auto=compress&cs=tinysrgb&w=500",
    description: "El hongo de la inmortalidad para relajación profunda y bienestar integral",
    benefits: ["Relajación", "Inmunidad", "Sueño Reparador", "Anti-estrés"],
    category: "extractos",
    featured: true,
    inStock: true
  },
  {
    id: 3,
    name: "Cordyceps Energía Natural",
    price: 38000,
    image: "https://images.pexels.com/photos/7195694/pexels-photo-7195694.jpeg?auto=compress&cs=tinysrgb&w=500",
    description: "Aumenta tu energía y resistencia física de manera natural y sostenible",
    benefits: ["Energía", "Resistencia", "Oxigenación", "Rendimiento"],
    category: "capsulas",
    featured: false,
    inStock: true
  },
  {
    id: 4,
    name: "Chaga Antioxidante Supremo",
    price: 45000,
    image: "https://images.pexels.com/photos/7195688/pexels-photo-7195688.jpeg?auto=compress&cs=tinysrgb&w=500",
    description: "Potente antioxidante para fortalecer tu sistema inmune y combatir el envejecimiento",
    benefits: ["Antioxidante", "Inmunidad", "Antiinflamatorio", "Longevidad"],
    category: "extractos",
    featured: false,
    inStock: true
  },
  {
    id: 5,
    name: "Shiitake Inmunidad Plus",
    price: 32000,
    originalPrice: 38000,
    image: "https://images.pexels.com/photos/7195690/pexels-photo-7195690.jpeg?auto=compress&cs=tinysrgb&w=500",
    description: "Fortalece tu sistema inmune con shiitake premium de cultivo orgánico",
    benefits: ["Inmunidad", "Digestión", "Cardiovascular", "Vitalidad"],
    category: "capsulas",
    featured: false,
    inStock: true
  },
  {
    id: 6,
    name: "Mix Adaptógeno Completo",
    price: 58000,
    image: "https://images.pexels.com/photos/7195695/pexels-photo-7195695.jpeg?auto=compress&cs=tinysrgb&w=500",
    description: "Combinación perfecta de hongos adaptógenos para equilibrio total",
    benefits: ["Adaptógeno", "Equilibrio", "Estrés", "Bienestar Integral"],
    category: "mezclas",
    featured: true,
    inStock: true
  },
  {
    id: 7,
    name: "Turkey Tail Inmuno",
    price: 40000,
    image: "https://images.pexels.com/photos/7195689/pexels-photo-7195689.jpeg?auto=compress&cs=tinysrgb&w=500",
    description: "Soporte inmunológico avanzado con extracto de cola de pavo",
    benefits: ["Inmunidad", "Digestión", "Microbioma", "Defensa Natural"],
    category: "extractos",
    featured: false,
    inStock: false
  },
  {
    id: 8,
    name: "Maitake Metabolismo",
    price: 36000,
    image: "https://images.pexels.com/photos/7195684/pexels-photo-7195684.jpeg?auto=compress&cs=tinysrgb&w=500",
    description: "Regula el metabolismo y apoya la salud cardiovascular",
    benefits: ["Metabolismo", "Cardiovascular", "Glucosa", "Peso Saludable"],
    category: "capsulas",
    featured: false,
    inStock: true
  }
];
---

<Layout title="Tienda - Be Nice Fungi Shop" description="Explora nuestra colección premium de hongos funcionales. Microdosis, extractos, cápsulas y mezclas especiales para tu bienestar natural.">
  <Header />
  
  <main class="pt-20">
    <!-- Hero Section -->
    <section class="py-16 bg-gradient-to-br from-cream-50 to-sage-50 relative overflow-hidden">
      <div class="absolute inset-0 opacity-10">
        <div class="ornamental-pattern w-full h-full"></div>
      </div>
      
      <div class="container mx-auto px-4 relative z-10">
        <div class="text-center max-w-4xl mx-auto">
          <h1 class="font-display text-5xl md:text-6xl font-bold text-earth-800 mb-6">
            Nuestra Tienda
          </h1>
          <p class="text-xl md:text-2xl text-earth-600 mb-8 leading-relaxed">
            Descubre nuestra cuidadosa selección de hongos funcionales premium, 
            cada uno elegido por sus propiedades únicas y beneficios comprobados para tu bienestar.
          </p>
          <div class="flex justify-center items-center space-x-4">
            <div class="w-16 h-0.5 bg-gradient-to-r from-transparent to-earth-500"></div>
            <div class="w-3 h-3 bg-earth-500 rounded-full"></div>
            <div class="w-2 h-2 bg-sage-500 rounded-full"></div>
            <div class="w-3 h-3 bg-mushroom-500 rounded-full"></div>
            <div class="w-2 h-2 bg-sage-500 rounded-full"></div>
            <div class="w-3 h-3 bg-earth-500 rounded-full"></div>
            <div class="w-16 h-0.5 bg-gradient-to-l from-transparent to-earth-500"></div>
          </div>
        </div>
      </div>
    </section>

    <!-- Filter Section -->
    <section class="py-8 bg-white border-b border-sage-200">
      <div class="container mx-auto px-4">
        <div class="flex flex-wrap justify-center gap-4">
          <button class="filter-btn active bg-sage-500 text-white px-6 py-3 rounded-full font-medium transition-all duration-300 hover:scale-105 shadow-lg" data-filter="all">
            Todos los Productos
          </button>
          <button class="filter-btn bg-sage-100 text-sage-700 hover:bg-sage-200 px-6 py-3 rounded-full font-medium transition-all duration-300 hover:scale-105" data-filter="microdosis">
            Microdosis
          </button>
          <button class="filter-btn bg-sage-100 text-sage-700 hover:bg-sage-200 px-6 py-3 rounded-full font-medium transition-all duration-300 hover:scale-105" data-filter="extractos">
            Extractos
          </button>
          <button class="filter-btn bg-sage-100 text-sage-700 hover:bg-sage-200 px-6 py-3 rounded-full font-medium transition-all duration-300 hover:scale-105" data-filter="capsulas">
            Cápsulas
          </button>
          <button class="filter-btn bg-sage-100 text-sage-700 hover:bg-sage-200 px-6 py-3 rounded-full font-medium transition-all duration-300 hover:scale-105" data-filter="mezclas">
            Mezclas Especiales
          </button>
        </div>
      </div>
    </section>

    <!-- Products Grid -->
    <section class="py-16 bg-cream-50">
      <div class="container mx-auto px-4">
        <div class="grid md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8" id="products-grid">
          {products.map((product) => (
            <div class={`product-card bg-white rounded-2xl shadow-lg overflow-hidden hover:shadow-xl transition-all duration-300 hover:scale-105 border-2 border-sage-100 ${product.featured ? 'ring-2 ring-earth-400' : ''}`} data-category={product.category}>
              {product.featured && (
                <div class="bg-earth-500 text-white text-center py-2 text-sm font-semibold">
                  ⭐ DESTACADO
                </div>
              )}
              
              <div class="relative aspect-square overflow-hidden">
                <img 
                  src={product.image} 
                  alt={product.name}
                  class="w-full h-full object-cover hover:scale-110 transition-transform duration-500"
                />
                {!product.inStock && (
                  <div class="absolute inset-0 bg-black/50 flex items-center justify-center">
                    <span class="bg-red-500 text-white px-4 py-2 rounded-full font-semibold">
                      Agotado
                    </span>
                  </div>
                )}
                {product.originalPrice && (
                  <div class="absolute top-4 left-4 bg-red-500 text-white px-3 py-1 rounded-full text-sm font-semibold">
                    ¡Oferta!
                  </div>
                )}
              </div>
              
              <div class="p-6">
                <h3 class="font-display text-xl font-semibold text-earth-800 mb-3">
                  {product.name}
                </h3>
                <p class="text-earth-600 mb-4 text-sm leading-relaxed">
                  {product.description}
                </p>
                
                <!-- Benefits -->
                <div class="flex flex-wrap gap-2 mb-4">
                  {product.benefits.slice(0, 3).map((benefit) => (
                    <span class="bg-sage-100 text-sage-700 px-3 py-1 rounded-full text-xs font-medium">
                      {benefit}
                    </span>
                  ))}
                  {product.benefits.length > 3 && (
                    <span class="text-sage-600 text-xs font-medium px-2 py-1">
                      +{product.benefits.length - 3} más
                    </span>
                  )}
                </div>
                
                <div class="flex justify-between items-center mb-4">
                  <div class="flex flex-col">
                    <span class="font-bold text-2xl text-earth-800">
                      ${product.price.toLocaleString()}
                    </span>
                    {product.originalPrice && (
                      <span class="text-sm text-gray-500 line-through">
                        ${product.originalPrice.toLocaleString()}
                      </span>
                    )}
                  </div>
                  <button 
                    class={`px-4 py-2 rounded-full font-medium transition-all duration-300 hover:scale-105 add-to-cart ${
                      product.inStock 
                        ? 'bg-sage-500 hover:bg-sage-600 text-white' 
                        : 'bg-gray-300 text-gray-500 cursor-not-allowed'
                    }`}
                    data-id={product.id}
                    data-name={product.name}
                    data-price={product.price}
                    disabled={!product.inStock}
                  >
                    {product.inStock ? 'Agregar' : 'Agotado'}
                  </button>
                </div>
                
                <a 
                  href={`/producto/${product.id}`}
                  class="block w-full text-center border-2 border-sage-500 text-sage-600 hover:bg-sage-500 hover:text-white px-4 py-2 rounded-full font-medium transition-all duration-300"
                >
                  Ver Detalles
                </a>
              </div>
            </div>
          ))}
        </div>
      </div>
    </section>

    <!-- Educational CTA -->
    <section class="py-16 bg-earth-800 text-cream-100">
      <div class="container mx-auto px-4">
        <div class="text-center max-w-4xl mx-auto">
          <h2 class="font-display text-3xl md:text-4xl font-bold mb-6">
            ¿Nuevo en el mundo de los hongos funcionales?
          </h2>
          <p class="text-xl mb-8 opacity-90">
            Descubre todo lo que necesitas saber sobre estos poderosos aliados naturales 
            en nuestra sección educativa completa.
          </p>
          <div class="flex flex-col sm:flex-row gap-4 justify-center">
            <a 
              href="/educacion"
              class="bg-sage-500 hover:bg-sage-600 text-white px-8 py-3 rounded-full font-semibold transition-all duration-300 hover:scale-105"
            >
              Guías de Consumo
            </a>
            <a 
              href="/nosotros"
              class="border-2 border-cream-100 text-cream-100 hover:bg-cream-100 hover:text-earth-800 px-8 py-3 rounded-full font-semibold transition-all duration-300 hover:scale-105"
            >
              Conoce Nuestra Historia
            </a>
          </div>
        </div>
      </div>
    </section>
  </main>

  <Footer />
  <Cart />

  <script>
    // Filter functionality
    document.addEventListener('DOMContentLoaded', function() {
      const filterButtons = document.querySelectorAll('.filter-btn');
      const productCards = document.querySelectorAll('.product-card');

      // Filter products
      filterButtons.forEach(button => {
        button.addEventListener('click', () => {
          const filter = button.dataset.filter;
          
          // Update active button
          filterButtons.forEach(btn => {
            btn.classList.remove('active', 'bg-sage-500', 'text-white');
            btn.classList.add('bg-sage-100', 'text-sage-700');
          });
          button.classList.add('active', 'bg-sage-500', 'text-white');
          button.classList.remove('bg-sage-100', 'text-sage-700');

          // Filter products
          productCards.forEach(card => {
            const category = card.dataset.category;
            if (filter === 'all' || category === filter) {
              card.style.display = 'block';
              card.classList.add('animate-fade-in');
            } else {
              card.style.display = 'none';
            }
          });
        });
      });

      // Cart functionality
      let cart = JSON.parse(localStorage.getItem('cart')) || [];

      function updateCartCount() {
        const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
        const cartCountElements = document.querySelectorAll('#cart-count, #mobile-cart-count');
        cartCountElements.forEach(el => {
          if (el) el.textContent = totalItems.toString();
        });
        
        // Dispatch custom event
        window.dispatchEvent(new CustomEvent('cartUpdated'));
      }

      function addToCart(id, name, price) {
        const existingItem = cart.find(item => item.id === id);
        
        if (existingItem) {
          existingItem.quantity += 1;
        } else {
          cart.push({
            id: id,
            name: name,
            price: price,
            quantity: 1
          });
        }
        
        localStorage.setItem('cart', JSON.stringify(cart));
        updateCartCount();
      }

      // Add to cart buttons
      document.querySelectorAll('.add-to-cart').forEach(button => {
        button.addEventListener('click', function() {
          if (this.disabled) return;
          
          const productId = this.dataset.id;
          const productName = this.dataset.name;
          const productPrice = parseInt(this.dataset.price);
          
          addToCart(productId, productName, productPrice);
          
          // Visual feedback
          this.textContent = '¡Agregado!';
          this.classList.add('bg-green-500');
          setTimeout(() => {
            this.textContent = 'Agregar';
            this.classList.remove('bg-green-500');
          }, 1000);
        });
      });

      updateCartCount();
    });
  </script>
</Layout>